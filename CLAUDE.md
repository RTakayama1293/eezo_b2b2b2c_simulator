# CLAUDE.md

## プロジェクト概要
- **目的**: 国内BtoB営業（飲食店開拓）とEEZO（EC）の同時並行モデルのコスト妥当性シミュレーション
- **背景**: 北海道食材専門商社・新日本海商事が検討する「飲食店体験→EC購入」の信頼転移型マーケティング戦略
- **評価指標**: 
  - LTV:CAC比率（目標4:1以上）
  - 損益分岐点までの期間
  - 3年間累計ROI

---

## Core Philosophy（基本原則）

### 1. Hypothesis-Driven（仮説駆動）
シミュレーションは仮説検証のツール。感度分析で不確実性を可視化する。

### 2. Plan Before Execute（計画先行）
パラメータ設定の根拠を明確にしてからシミュレーションを実行。

### 3. Immutability（不変性）
data/raw/ のパラメータ定義は絶対に変更しない。シナリオ変更はコピーして実施。

### 4. Reproducibility（再現性）
乱数シードを固定し、同じパラメータで同じ結果が得られることを保証。

### 5. Transparency（透明性）
計算ロジックと前提条件を常に明示。ブラックボックス化しない。

---

## Critical Rules（絶対ルール）

コミット前の必須チェック:
- [ ] パラメータの出典・根拠がdocstringまたはコメントで明記されていること
- [ ] 金額単位（円/万円）が統一されていること
- [ ] data/raw/ 配下のファイルを編集していないこと
- [ ] 感度分析の範囲が現実的であること（±50%以内を推奨）

---

## シミュレーションモデル定義

### 3つの比較シナリオ

| シナリオ | 説明 | 主要コスト |
|----------|------|------------|
| **A. BtoB単独** | 飲食店への直接営業のみ | 人件費、交通費、サンプル費 |
| **B. EEZO単独** | デジタル広告中心のEC展開 | 広告費、システム費、物流費 |
| **C. 同時並行** | BtoB営業→EC送客のハイブリッド | A+B+インセンティブ費 |

### 主要KPI定義

| KPI | 計算式 | 目標値 |
|-----|--------|--------|
| **CAC** | 総獲得コスト÷新規顧客数 | - |
| **LTV** | 平均購入単価×購入頻度×継続期間 | CAC×4以上 |
| **CVR（店舗経由）** | EC購入数÷QRスキャン数 | 8% |
| **リピート率** | 再購入顧客数÷初回購入顧客数 | 25-30% |
| **月間EC売上（店舗経由）** | 顧客単価×購入者数 | 500万円 |

---

## データセット情報

### パラメータファイル (data/raw/parameters.csv)

| カラム名 | 型 | 説明 | 単位 |
|----------|-----|------|------|
| category | str | パラメータカテゴリ | - |
| param_name | str | パラメータ名 | - |
| base_value | float | 基準値 | 各種 |
| unit | str | 単位 | - |
| min_value | float | 感度分析下限 | 各種 |
| max_value | float | 感度分析上限 | 各種 |
| source | str | 出典 | - |

### BtoB営業コストパラメータ (data/raw/btob_costs.csv)

| カラム名 | 型 | 説明 |
|----------|-----|------|
| cost_item | str | コスト項目名 |
| monthly_cost | float | 月額コスト（円） |
| variable_per_visit | float | 訪問あたり変動費（円） |
| note | str | 備考 |

### EEZO運営パラメータ (data/raw/eezo_params.csv)

| カラム名 | 型 | 説明 |
|----------|-----|------|
| param_name | str | パラメータ名 |
| value | float | 値 |
| unit | str | 単位 |
| source | str | 出典 |

---

## Available Commands（利用可能なコマンド）

| キーワード | 内容 | 使い方 |
|-----------|------|--------|
| `シミュレーション実行` | 3シナリオ比較シミュレーション | 「3シナリオのシミュレーション実行して」 |
| `感度分析` | 主要パラメータの感度分析 | 「CACの感度分析をして」 |
| `損益分岐点計算` | BEP算出 | 「シナリオCの損益分岐点計算して」 |
| `パラメータ確認` | 現在のパラメータ一覧表示 | 「BtoB営業のパラメータ確認」 |
| `レポート生成` | 分析結果のMarkdownレポート | 「シミュレーション結果のレポート生成」 |

---

## Context Modes（コンテキストモード）

### 分析モード（デフォルト）
- シミュレーション実行と結果解釈を重視
- 可視化とレポーティングを優先

### 探索モード
- パラメータの妥当性を検証
- 類似事例や業界ベンチマークを参照

### 検証モード
- 計算ロジックの正確性をチェック
- エッジケースの確認

---

## 技術スタック

- Python 3.x
- pandas, numpy（データ処理）
- matplotlib, seaborn, plotly（可視化）
- scipy（統計計算）

---

## ディレクトリルール

1. **data/raw/** - パラメータ定義ファイル、**絶対に編集しない**
2. **data/processed/** - シミュレーション結果データ
3. **experiments/expXXX_[説明]/** - 各シナリオ分析は独立ディレクトリ
4. **src/** - シミュレーションモジュール
5. **skills/** - ドメイン知識・ワークフロー定義
6. **outputs/** - 最終レポート・可視化結果

---

## コーディング規約

- 型ヒント必須
- docstring必須（Google形式）、特に計算式の説明を必ず含める
- 金額は基本的に「円」単位で処理、表示時に万円変換
- 乱数使用時はseed固定（default: 42）

---

## シミュレーションワークフロー（skills/simulation-workflow.md を参照）

1. パラメータ読み込み・妥当性確認
2. 各シナリオのコスト・売上計算
3. KPI算出（CAC, LTV, ROI, BEP）
4. 感度分析（主要パラメータ±30%）
5. 可視化（比較チャート、ウォーターフォール）
6. 結果をMarkdownレポートにまとめる

---

## ドメイン知識

### 新日本海商事について
- 北海道食材専門商社、新日本海フェリーの子会社
- EC「EEZO」を運営、BtoB/BtoC両軸展開
- 小規模組織（9名）での効率的運営が課題

### 戦略背景
- 「飲食店体験→EC購入」の信頼転移モデルを検討中
- ワイナリー（CVR8.7%）やクラフトビール（CVR10-15%）で実証済み
- デジタル広告CPA高騰への対抗策として注目

### 業界ベンチマーク
- 食品EC化率: 4.16%（全業種最低水準）
- 飲食予約サイト送客手数料: 8-15%
- 成功事例のLTV:CAC比率: 4:1以上

詳細は skills/domain-knowledge.md を参照
